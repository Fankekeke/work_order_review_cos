
<!--状态栏区域-->
<view class="cu-custom" style="0px;">
    <view class="cu-bar fixed none-bg text-white bg-img" style="height:{{CustomBar}}px;padding-top:{{StatusBar}}px;">
        <view class="head-title canui-head-title"></view>
    </view>
</view>

<view class="cu-bar bg-white margin-top solid-bottom">
    <view class='action'>
        <text class='icon-list text-green'></text>
        <text style="font-size: 14px">我的作业单</text>
    </view>
</view>

<view class="bg-white" style="padding:0 30rpx;padding-bottom: 20rpx;padding-top: 20rpx;">
    <view class='work-order-list'>
        <view wx:for="{{ workOrderList }}" wx:key="id" class="work-order-item">
            <view class="cu-card case shadow-warp bg-white">
                <view class="cu-item" style="margin: 0">
                    <!-- 作业单头部信息 -->
                    <view class="work-order-header">
                        <view class="ticket-info">
                            <text class="ticket-label">作业票编号:</text>
                            <text class="ticket-code">{{ item.ticketCode }}</text>
                        </view>
                        <view class="work-type">
                            <text class="type-label">作业类型:</text>
                            <text class="type-value">{{ item.type }}</text>
                        </view>
                    </view>

                    <!-- 作业单状态 -->
                    <view class="work-status">
                        <view class="status-badge status-pending" wx:if="{{ item.status == 1 }}">正在初审</view>
                        <view class="status-badge status-processing" wx:elif="{{ item.status == 2 }}">正在复审</view>
                        <view class="status-badge status-approved" wx:elif="{{ item.status == 3 }}">正在终审</view>
                        <view class="status-badge status-rejected" wx:elif="{{ item.status == 4 }}">已驳回</view>
                        <view class="status-badge status-completed" wx:elif="{{ item.status == 5 }}">安全措施</view>
                        <view class="status-badge status-cancelled" wx:else>措施落实</view>
                    </view>

                    <!-- 申请人信息 -->
                    <view class="applicant-info">
                        <view class="cu-avatar radius" style="background-image:url(http://127.0.0.1:9527/imagesWeb/{{ item.staffImages }});"></view>
                        <view class="applicant-details">
                            <view class="applicant-name">{{ item.staffName }}</view>
                            <view class="applicant-position">{{ item.deptName }} - {{ item.positionName }}</view>
                        </view>
                    </view>

                    <!-- 作业内容 -->
                    <view class="work-content-section">
                        <view class="section-title">作业内容</view>
                        <view class="content-text">{{ item.workContent }}</view>
                    </view>

                    <!-- 地点和时间信息 -->
                    <view class="location-time-info">
                        <view class="info-row">
                            <view class="info-item">
                                <text class="info-label">作业地点:</text>
                                <text class="info-value">{{ item.location }}</text>
                            </view>
                        </view>
                        <view class="info-row">
                            <view class="info-item">
                                <text class="info-label">开始时间:</text>
                                <text class="info-value">{{ item.startTime }}</text>
                            </view>
                            <view class="info-item">
                                <text class="info-label">结束时间:</text>
                                <text class="info-value">{{ item.endTime }}</text>
                            </view>
                        </view>
                    </view>

                    <!-- 风险和评分信息 -->
                    <view class="risk-score-info">
                        <view class="risk-section">
                            <text class="risk-label">风险等级:</text>
                            <view class="risk-badge risk-high" wx:if="{{ item.riskLevel == '高' }}">高风险</view>
                            <view class="risk-badge risk-medium" wx:elif="{{ item.riskLevel == '中' }}">中风险</view>
                            <view class="risk-badge risk-low" wx:else>低风险</view>
                        </view>
                        <view class="score-section">
                            <text class="score-label">AI审核评分:</text>
                            <text class="score-value">{{ item.aiAuditScore }}分</text>
                        </view>
                    </view>

                    <!-- 操作按钮 -->
                    <view class="action-buttons">
                        <button class="cu-btn line-blue sm" bindtap="viewDetail" data-id="{{ item.id }}">查看详情</button>
                        <button class="cu-btn line-green sm" bindtap="editOrder" data-id="{{ item.id }}" wx:if="{{ item.status <= 2 }}">编辑</button>
                        <button class="cu-btn line-green sm" bindtap="safetyOrder" data-id="{{ item.id }}" wx:if="{{ item.status == 5 }}">安全审查</button>
                    </view>
                </view>
            </view>
        </view>
    </view>

    <!-- 空状态 -->
    <view style="padding: 20px;display: block" wx:if="{{workOrderList.length == 0}}">
        <view class="flex-sub text-center">
            <view class="solid-bottom text-xl padding">
                <text class="text-black">暂无作业单信息</text>
            </view>
        </view>
    </view>
</view>
